<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MES Sports Portal - Hariom Sharma</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #020617; color: white; margin: 0; }
        .header-font { font-family: 'Oswald', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); }
        .input-field { background: #0f172a; border: 1px solid #1e293b; color: white; transition: 0.3s; }
        .input-field:focus { border-color: #6366f1; outline: none; }
        .btn-gradient { background: linear-gradient(135deg, #4f46e5, #9333ea); cursor: pointer; }
        
        /* Dropdown Visibility Fix */
        select option { background: #0f172a; color: white; padding: 10px; }
        
        .cap-card { padding: 5px 8px; border-radius: 6px; font-size: 10px; font-weight: 700; text-transform: uppercase; margin-bottom: 4px; border-left: 3px solid; background: rgba(255,255,255,0.03); }
        .red-t { border-color: #ef4444; color: #f87171; }
        .yellow-t { border-color: #facc15; color: #facc15; }
        .green-t { border-color: #22c55e; color: #4ade80; }
        .blue-t { border-color: #3b82f6; color: #60a5fa; }

        /* Premium Developer Branding */
        .dev-footer { background: linear-gradient(to top, rgba(250, 204, 21, 0.15), transparent); border-top: 2px solid rgba(250, 204, 21, 0.3); padding: 50px 20px; text-align: center; margin-top: 50px; }
        .dev-name { color: #facc15; font-size: 2rem; font-weight: 800; text-transform: uppercase; letter-spacing: 6px; text-shadow: 0 0 25px rgba(250, 204, 21, 0.8); display: inline-block; position: relative; }
        .dev-name::after { content: ''; display: block; width: 60%; height: 3px; background: #facc15; margin: 10px auto; box-shadow: 0 0 15px #facc15; border-radius: 10px; }
    </style>
</head>
<body class="pb-10">

    <header class="p-10 text-center bg-slate-900 border-b border-indigo-500/30 shadow-2xl">
        <h1 class="header-font text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500 uppercase italic">
            My English School Suryakheda
        </h1>
        <p class="mt-2 text-yellow-500 font-bold tracking-[0.3em] text-sm uppercase">Sports & Events  2025-26</p>
    </header>

    <div class="container mx-auto px-4 mt-8 max-w-7xl">
        
        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4 border-b border-white/5 pb-4">
            <h2 class="header-font text-xl text-indigo-400 uppercase italic tracking-widest">üìä Class-Wise Standings</h2>
            <div class="flex items-center gap-3 bg-slate-800 p-2 rounded-xl border border-indigo-500/50">
                <span class="text-[10px] font-bold text-gray-400 ml-2 uppercase">View Class:</span>
                <select id="classFilter" onchange="updateClassUI()" class="bg-slate-800 text-white font-bold text-sm focus:outline-none cursor-pointer pr-4 border-none">
                    <option value="Nursery">Nursery</option><option value="LKG">LKG</option><option value="UKG">UKG</option>
                    <script>for(let i=1; i<=12; i++) document.write(`<option value="Class ${i}">Class ${i}</option>`);</script>
                </select>
            </div>
        </div>

        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
            <div class="glass p-4 rounded-2xl border-b-4 border-red-500 text-center"><p class="text-[9px] text-gray-400 font-bold uppercase">Red</p><div id="c-red" class="text-3xl font-black text-red-500">0</div></div>
            <div class="glass p-4 rounded-2xl border-b-4 border-yellow-400 text-center"><p class="text-[9px] text-gray-400 font-bold uppercase">Yellow</p><div id="c-yellow" class="text-3xl font-black text-yellow-400">0</div></div>
            <div class="glass p-4 rounded-2xl border-b-4 border-green-500 text-center"><p class="text-[9px] text-gray-400 font-bold uppercase">Green</p><div id="c-green" class="text-3xl font-black text-green-500">0</div></div>
            <div class="glass p-4 rounded-2xl border-b-4 border-blue-500 text-center"><p class="text-[9px] text-gray-400 font-bold uppercase">Blue</p><div id="c-blue" class="text-3xl font-black text-blue-500">0</div></div>
        </div>

        <h2 class="header-font text-2xl text-center mb-8 text-white uppercase tracking-widest italic border-b-2 border-indigo-500 w-fit mx-auto">School Overall Ranking üèÜ</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <div class="glass p-5 rounded-[30px] border-t-4 border-red-500 shadow-xl">
                <h3 class="text-red-500 font-black text-xs uppercase mb-1">Red Group Total</h3>
                <p id="total-red" class="text-5xl font-black mb-4">0</p>
                <div class="space-y-1">
                    <div class="cap-card red-t">BOY CAPT: NAYAN PATIDAR</div>
                    <div class="cap-card red-t">BOY V-CAPT: NAME HERE</div>
                    <div class="cap-card red-t">GIRL CAPT: KOMAL CHOUHAN</div>
                    <div class="cap-card red-t">GIRL V-CAPT: NAME HERE</div>
                </div>
            </div>
            <div class="glass p-5 rounded-[30px] border-t-4 border-yellow-400 shadow-xl">
                <h3 class="text-yellow-400 font-black text-xs uppercase mb-1">Yellow Group Total</h3>
                <p id="total-yellow" class="text-5xl font-black mb-4">0</p>
                <div class="space-y-1">
                    <div class="cap-card yellow-t">BOY CAPT: SHUBHAM PATIDAR</div>
                    <div class="cap-card yellow-t">BOY V-CAPT: NAME HERE</div>
                    <div class="cap-card yellow-t">GIRL CAPT: SHARDDHA PATIDAR</div>
                    <div class="cap-card yellow-t">GIRL V-CAPT: DOLI KACHWA</div>
                </div>
            </div>
            <div class="glass p-5 rounded-[30px] border-t-4 border-green-500 shadow-xl">
                <h3 class="text-green-500 font-black text-xs uppercase mb-1">Green Group Total</h3>
                <p id="total-green" class="text-5xl font-black mb-4">0</p>
                <div class="space-y-1">
                    <div class="cap-card green-t">BOY CAPT: SHUBHAM SHARMA</div>
                    <div class="cap-card green-t">BOY V-CAPT: NAME HERE</div>
                    <div class="cap-card green-t">GIRL CAPT: NAME HERE</div>
                    <div class="cap-card green-t">GIRL V-CAPT: VARSHA PATIDAR</div>
                </div>
            </div>
            <div class="glass p-5 rounded-[30px] border-t-4 border-blue-500 shadow-xl">
                <h3 class="text-blue-500 font-black text-xs uppercase mb-1">Blue Group Total</h3>
                <p id="total-blue" class="text-5xl font-black mb-4">0</p>
                <div class="space-y-1">
                    <div class="cap-card blue-t">BOY CAPT: NAME HERE</div>
                    <div class="cap-card blue-t">BOY V-CAPT: NAME HERE</div>
                    <div class="cap-card blue-t">GIRL CAPT: NAME HERE</div>
                    <div class="cap-card blue-t">GIRL V-CAPT: NAME HERE</div>
                </div>
            </div>
        </div>

        <div class="glass p-8 rounded-[40px] border-l-4 border-indigo-500 shadow-2xl mb-12">
            <h2 class="header-font text-2xl mb-8 text-indigo-400 uppercase italic font-bold">Admin Portal üõ†Ô∏è</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Entry Type</label>
                    <select id="typeSelect" class="input-field w-full p-4 rounded-2xl mt-1 font-bold text-yellow-500">
                        <option value="Both">Class & Overall Both</option>
                        <option value="Overall">Overall Only</option>
                    </select>
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Event Name</label>
                    <input type="text" id="game" placeholder="e.g. Cricket" class="input-field w-full p-4 rounded-2xl mt-1">
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Student Name</label>
                    <input type="text" id="student" placeholder="Full Name" class="input-field w-full p-4 rounded-2xl mt-1">
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Class</label>
                    <select id="classSelect" class="input-field w-full p-4 rounded-2xl mt-1">
                        <option>Nursery</option><option>LKG</option><option>UKG</option>
                        <script>for(let i=1;i<=12;i++) document.write(`<option>Class ${i}</option>`);</script>
                    </select>
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Group</label>
                    <select id="groupSelect" class="input-field w-full p-4 rounded-2xl mt-1 font-bold">
                        <option value="Red">Red Group</option><option value="Yellow">Yellow Group</option>
                        <option value="Green">Green Group</option><option value="Blue">Blue Group</option>
                    </select>
                </div>
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Select Position (Rank)</label>
                    <select id="pointsSelect" class="input-field w-full p-4 rounded-2xl mt-1 text-indigo-400 font-bold">
                        <option value="3">ü•á 1st Rank (3 Pts)</option>
                        <option value="2">ü•à 2nd Rank (2 Pts)</option>
                        <option value="1">ü•â 3rd Rank (1 Pt)</option>
                    </select>
                </div>
                <div class="lg:col-span-3 flex justify-end mt-4">
                    <button onclick="sendToExcel()" id="btn" class="btn-gradient w-full py-5 rounded-2xl font-black uppercase tracking-widest shadow-xl">
                        Submit To Excel & Web üöÄ
                    </button>
                </div>
            </div>
            
        </div>
    </div>
    

    <footer class="dev-footer">
        <p class="text-gray-500 text-[10px] tracking-[0.5em] uppercase mb-4">Architect & Lead Developer</p>
        <div class="dev-name">HARIOM SHARMA</div>
        <p class="mt-4 text-[11px] text-gray-400 font-bold tracking-[0.2em] uppercase">Built for Excellence | 2025-26</p>
    </footer>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyX3yvtPcTrkngcj7zk9INBJGsa6gvqcxg1eVMU4DJZ0YGmp4anNAykYrhxtmw4w_tR/exec"; 
        
        let localData = [];
        let overallScores = { Red: 0, Yellow: 0, Green: 0, Blue: 0 };

        function sendToExcel() {
            const btn = document.getElementById('btn');
            const pSelect = document.getElementById('pointsSelect');
            const rName = pSelect.options[pSelect.selectedIndex].text.split('(')[0].trim();
            const password = prompt("Admin Authorization Required! Enter Password:");
if (password !== "SITAMAU") { 
    alert("Wrong Password! Only Hariom Sharma can enter data.");
    return;
}

            const data = {
                type: document.getElementById('typeSelect').value,
                game: document.getElementById('game').value.trim(),
                student: document.getElementById('student').value.trim(),
                className: document.getElementById('classSelect').value,
                group: document.getElementById('groupSelect').value,
                points: parseInt(pSelect.value),
                rankName: rName
            };

            if(!data.game || !data.student) { alert("Game and Name are required!"); return; }

            btn.innerText = "SENDING TO EXCEL..."; btn.disabled = true;

            fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(data) })
            .then(() => {
                localData.push(data);
                overallScores[data.group] += data.points;
                updateTotalUI();
                updateClassUI();
                btn.innerText = "Submit To Excel & Web üöÄ"; btn.disabled = false;
                document.getElementById('student').value = "";
                document.getElementById('game').value = "";
            })
            .catch(() => {
                alert("Data saved locally! Cloud sync failed.");
                btn.disabled = false;
            });
        }

        function updateTotalUI() {
            document.getElementById('total-red').innerText = overallScores.Red;
            document.getElementById('total-yellow').innerText = overallScores.Yellow;
            document.getElementById('total-green').innerText = overallScores.Green;
            document.getElementById('total-blue').innerText = overallScores.Blue;
        }

        function updateClassUI() {
            const currentClass = document.getElementById('classFilter').value;
            let cTotals = { Red: 0, Yellow: 0, Green: 0, Blue: 0 };
            localData.forEach(entry => {
                if(entry.className === currentClass && entry.type === "Both") {
                    cTotals[entry.group] += entry.points;
                }
            });
            document.getElementById('c-red').innerText = cTotals.Red;
            document.getElementById('c-yellow').innerText = cTotals.Yellow;
            document.getElementById('c-green').innerText = cTotals.Green;
            document.getElementById('c-blue').innerText = cTotals.Blue;
        }
    </script>
</body>
</html>
